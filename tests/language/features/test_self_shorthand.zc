struct Vec2 {
    x: float;
    y: float;
}

impl Vec2 {
    fn length_squared(self) -> float {
        return .x * .x + .y * .y;
    }

    fn scale(self, factor: float) {
        .x = .x * factor;
        .y = .y * factor;
    }

    fn add(self, other: Vec2) -> Vec2 {
        return Vec2 { x: .x + other.x, y: .y + other.y };
    }
}

test "self_shorthand" {
    let v = Vec2 { x: 3.0, y: 4.0 };
    let len_sq = v.length_squared();
    println "length_squared = {len_sq}";
    assert(len_sq == 25.0, "length_squared should be 25");

    v.scale(2.0);
    println "scaled: ({v.x}, {v.y})";
    assert(v.x == 6.0, "x should be 6");
    assert(v.y == 8.0, "y should be 8");

    let v2 = Vec2 { x: 1.0, y: 1.0 };
    let sum = v.add(v2);
    println "sum: ({sum.x}, {sum.y})";
    assert(sum.x == 7.0, "sum.x should be 7");

    println "Self shorthand OK";
}
